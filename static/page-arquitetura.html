<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Tech Challenge - Fase 1 - P√≥s-Tech Machine Learning Engineering</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">

    <link rel="stylesheet" href="/static/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/css/icomoon-social.css">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700,600,800' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="/static/css/leaflet.css" />
    <!--[if lte IE 8]>
		    <link rel="stylesheet" href="/static/css/leaflet.ie.css" />
		<![endif]-->
    <link rel="stylesheet" href="/static/css/main.css">

    <script src="/static/js/modernizr-2.6.2-respond-1.1.0.min.js"></script>
</head>

<body>
    <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->


    <!-- Navigation & Logo-->
    <div class="mainmenu-wrapper">
        <div class="container">
            <nav id="mainmenu" class="mainmenu">
                <ul>
                    <li class="logo-wrapper"><a href="index.html"><img src="/static/img/pos-tech-logo.png"
                                alt="Pos Tech"></a></li>
                    <li><a href="/static/index.html">Home</a></li>
                    <li><a href="/static/page-tecnologias.html">Tecnologias</a></li>
                    <li class="active"><a href="/static/page-arquitetura.html">Arquitetura</a></li>
                    <li><a href="/static/page-documentacao.html">Documenta√ß√£o da API</a></li>
                </ul>
            </nav>
        </div>
    </div>

    <!-- Page Title -->
    <div class="section section-breadcrumbs">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <h1>üç∑ Tech Challenge - Fase 1 - Machine Learning Engineering</h1>
                </div>
            </div>
        </div>
    </div>

    <div class="section">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <!-- Job Description -->
                    <div class="job-details-wrapper">
                        <h3>Fluxo Completo da Arquitetura do Sistema</h3>
                        <p>
                            A seguir, apresentamos o fluxo completo da arquitetura do sistema, desde a intera√ß√£o inicial
                            do cliente at√© o retorno dos dados raspados ou fallback.
                        </p>
                        <!-- Diagrama Visual -->
                        <div class="well text-center">
                            <img src="/static/img/arquitetura_api.png" alt="Diagrama da Arquitetura"
                                class="img-responsive center-block" style="max-width: 100%; height: auto;">
                            <p><em>Diagrama do fluxo completo do sistema</em></p>
                        </div>

                        <hr />

                        <h3>1. Intera√ß√£o do Cliente</h3>
                        <p>O processo come√ßa com o acesso do cliente √† API:</p>
                        <ul>
                            <li><strong>Cadastro:</strong> O usu√°rio se cadastra via rota `/register`.</li>
                            <li><strong>Login:</strong> Ap√≥s cadastro, o usu√°rio faz login via `/login`, recebendo um
                                token JWT.</li>
                            <li><strong>Consumo da API:</strong> O token √© usado nas rotas protegidas via header
                                `Authorization: Bearer <token>`.</li>
                        </ul>

                        <hr />

                        <h3>2. Autentica√ß√£o ‚Äì JWT</h3>
                        <p>A autentica√ß√£o √© feita usando tokens JWT, garantindo seguran√ßa no acesso √†s rotas protegidas:
                        </p>
                        <ul>
                            <li>Dados do usu√°rio s√£o armazenados no banco SQLite;</li>
                            <li>Ap√≥s login bem-sucedido, um token JWT √© gerado;</li>
                            <li>O token deve ser enviado em todas as requisi√ß√µes √†s rotas protegidas;</li>
                            <li>O middleware `get_current_user` valida o token antes de liberar o acesso.</li>
                        </ul>

                        <hr />

                        <h3>3. Raspagem de Dados ‚Äì BeautifulSoup</h3>
                        <p>A API realiza web scraping direto do site da Embrapa:</p>
                        <ul>
                            <li>Rota chama fun√ß√£o `scrape_embrapa()`;</li>
                            <li>Faz requisi√ß√£o HTTP e extrai dados das tabelas HTML;</li>
                            <li>Retorna dados no formato JSON estruturado.</li>
                        </ul>

                        <hr />

                        <h3>4. Fallback Local ‚Äì CSV</h3>
                        <p>Para garantir disponibilidade mesmo quando o site da Embrapa estiver fora do ar:</p>
                        <ul>
                            <li>Se o scraping falhar, o sistema busca dados de arquivos CSV locais;</li>
                            <li>Os dados s√£o carregados com pandas e retornados no mesmo formato JSON;</li>
                            <li>Permite valida√ß√£o do funcionamento mesmo durante corre√ß√£o offline.</li>
                        </ul>

                        <hr />

                        <h3>5. Banco de Dados ‚Äì SQLite</h3>
                        <p>O sistema usa SQLite para armazenar usu√°rios registrados:</p>
                        <ul>
                            <li>Cont√©m informa√ß√µes: nome, e-mail, senha hash e status;</li>
                            <li>Gerenciado pelo SQLAlchemy ORM;</li>
                            <li>Usado apenas para persist√™ncia de usu√°rios ‚Äî n√£o h√° cache de dados da Embrapa.</li>
                        </ul>

                        <hr />

                        <h3>6. API REST ‚Äì FastAPI</h3>
                        <p>A API REST, constru√≠da com FastAPI, coordena todo o sistema:</p>
                        <ul>
                            <li>Recebe requisi√ß√µes do cliente;</li>
                            <li>Realiza autentica√ß√£o com token JWT;</li>
                            <li>Invoca a raspagem ou fallback;</li>
                            <li>Retorna resposta JSON padronizada;</li>
                            <li>Documenta√ß√£o autom√°tica via Swagger UI.</li>
                        </ul>

                        <hr />

                        <h3>7. Documenta√ß√£o ‚Äì Swagger UI</h3>
                        <p>O FastAPI gera automaticamente uma interface de documenta√ß√£o interativa:</p>
                        <ul>
                            <li>Dispon√≠vel em <code>/docs</code>;</li>
                            <li>Permite testar rotas diretamente no navegador;</li>
                            <li>Inclui bot√£o "Authorize" para inserir o token JWT;</li>
                            <li>Mostra modelos de requisi√ß√£o/resposta e poss√≠veis erros.</li>
                        </ul>

                        <hr />

                        <h3>8. Plano de Deploy ‚Äì Render</h3>
                        <p>A API foi implantada online via plataforma Render:</p>
                        <ul>
                            <li>URL p√∫blica para acesso remoto;</li>
                            <li>Atualiza√ß√£o autom√°tica via GitHub;</li>
                            <li>Suporte a vari√°veis de ambiente e configura√ß√µes customizadas;</li>
                            <li>Escal√°vel para futuras melhorias.</li>
                        </ul>

                        <hr />

                        <h3>9. Exemplo de Fluxo de Acesso</h3>
                        <ol>
                            <li>Usu√°rio acessa a API via Swagger ou Postman;</li>
                            <li>Faz cadastro em `/register` com nome, e-mail e senha;</li>
                            <li>Realiza login em `/login` e recebe um token JWT;</li>
                            <li>Insere o token no cabe√ßalho Authorization;</li>
                            <li>Chama um endpoint protegido, como `/producao/2023`;</li>
                            <li>A API tenta raspar os dados ao vivo do site da Embrapa;</li>
                            <li>Se o site estiver fora do ar, retorna dados de CSV local;</li>
                            <li>Dados s√£o formatados em JSON e devolvidos ao cliente.</li>
                        </ol>

                        <hr />

                        <h3>10. Considera√ß√µes sobre Resili√™ncia</h3>
                        <p>O sistema foi projetado para ser resiliente:</p>
                        <ul>
                            <li>Autentica√ß√£o segura com token JWT;</li>
                            <li>Web scraping din√¢mico com fallback local;</li>
                            <li>Rotas bem documentadas e test√°veis;</li>
                            <li>Banco de dados leve e eficiente;</li>
                            <li>Interface web b√°sica para navega√ß√£o e documenta√ß√£o;</li>
                            <li>Deploy funcional e p√∫blico para valida√ß√£o externa.</li>
                        </ul>

                        <hr />

                        <h3>11. Melhorias Futuras (Opcionais)</h3>
                        <p>Embora o projeto atenda aos requisitos m√≠nimos, algumas melhorias podem ser adicionadas
                            posteriormente:</p>
                        <ul>
                            <li>Implementa√ß√£o de cache para reduzir requisi√ß√µes ao site;</li>
                            <li>Uso de Docker para containeriza√ß√£o;</li>
                            <li>Pipeline CI/CD para automatizar testes e deploy;</li>
                            <li>Dashboard com Streamlit ou React para visualiza√ß√£o dos dados;</li>
                            <li>Modelo de Machine Learning alimentado pela pr√≥pria API.</li>
                        </ul>

                        <hr />

                        <h3>12. Resumo do Fluxo</h3>
                        <pre>
[Cliente] 
   ‚Üì (cadastro/login)
[API REST - FastAPI] 
   ‚Üì (autentica√ß√£o JWT)
[Web Scraping ‚Üí Site da Embrapa] OU [Fallback ‚Üí CSV local]
   ‚Üì (dados raspados ou salvos)
[Resposta JSON ‚Üí Cliente]
                        </pre>

                        <hr />

                        <h3>13. Boas Pr√°ticas Adotadas</h3>
                        <ul>
                            <li>Organiza√ß√£o modular do c√≥digo;</li>
                            <li>Modelos Pydantic para valida√ß√£o autom√°tica;</li>
                            <li>Tratamento de exce√ß√µes e logs claros;</li>
                            <li>README.md detalhado com instru√ß√µes de execu√ß√£o;</li>
                            <li>Vari√°veis de ambiente para configura√ß√£o;</li>
                            <li>Depend√™ncias injetadas com SQLAlchemy e Depends;</li>
                            <li>Testes manuais poss√≠veis via Swagger;</li>
                            <li>Fallback seguro para situa√ß√µes de instabilidade;</li>
                            <li>Interface web simples com Bootstrap.</li>
                        </ul>

                        <hr />

                        <h3>14. Conclus√£o</h3>
                        <p>
                            Este projeto demonstra uma solu√ß√£o pr√°tica e escal√°vel para extra√ß√£o e consulta de dados
                            p√∫blicos de vitivinicultura. Composta por web scraping, autentica√ß√£o segura, fallback
                            inteligente e documenta√ß√£o interativa, a API cumpre seu papel de forma robusta e preparada
                            para futuras etapas de an√°lise e modelagem de Machine Learning.
                        </p>

                    </div>
                    <!-- End Job Description -->
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-footer col-md-4 col-xs-6">
                    <h3>Dados do Aluno</h3>
                    <p class="contact-us-details">
                        <b>Nome:</b> Alex Soares da Silva<br />
                        <b>Linkedin:</b> <a href="//www.linkedin.com/in/alexsoares4a/"
                            target="_blank">alexsoares4a</a><br />
                        <b>Email:</b> <a
                            href="mailto:getintoutch@yourcompanydomain.com">getintoutch@yourcompanydomain.com</a>
                    </p>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="footer-copyright">&copy; 2013 mPurpose. All rights reserved.</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Javascripts -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.9.1.min.js"><\/script>')</script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="http://cdn.leafletjs.com/leaflet-0.5.1/leaflet.js"></script>
    <script src="/static/js/jquery.fitvids.js"></script>
    <script src="/static/js/jquery.sequence-min.js"></script>
    <script src="/static/js/jquery.bxslider.js"></script>
    <script src="/static/js/main-menu.js"></script>
    <script src="/static/js/template.js"></script>
</body>

</html>
